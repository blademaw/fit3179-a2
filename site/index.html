<!DOCTYPE html>
<html>

<head>
    <title>Vega Lite Homework W9</title>
    <meta charset="utf-8" />

    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

    <style media="screen">
        /* Add space between Vega-Embed links  */
        .vega-actions a {
            margin-right: 5px;
        }

        h1 {
            text-align: center;
        }
    </style>
</head>

<body>
    <h1>Week 9 Homework Visualisation</h1>
    <!-- Container for the visualization -->
    <!-- <div id="vis"></div>
    <div id="vis2"></div> -->
    <div id="vis3"></div>

    <script>
        // new choropleth
        var vlSpec3 = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": 800,
            "height": 500,
            "title": "Median Airbnb nightly costs across Melbourne LGAs",
            "projection": {
                "type": "mercator"
            },
            "params": [{
                    "name": "highlight",
                    "select": {
                        "type": "point",
                        "on": "mouseover"
                    }
                },
                {
                    "name": "select",
                    "select": "point"
                }
            ],
            "layer": [{
                "data": {
                    "url": "https://raw.githubusercontent.com/blademaw/fit3179-a2/main/vic_lga.json?token=AFTGRD5COY3EFTLPY5UWI7LBJVSSI",
                    "format": {
                        "type": "topojson",
                        "feature": "vic_lga"
                    }
                },
                "transform": [{
                    "lookup": "properties.ABB_NAME",
                    "from": {
                        "data": {
                            "url": "https://raw.githubusercontent.com/blademaw/fit3179-a2/main/listings_agg.csv?token=AFTGRD5DLT2JAH4JY3ANLTTBKR6C4",
                            "format": {
                                "type": "csv"
                            }
                        },
                        "key": "city",
                        "fields": ["med_price"]
                    }
                }],
                "mark": {
                    "type": "geoshape",
                    "stroke": "white"
                },
                "encoding": {
                    "color": {
                        "field": "med_price",
                        "type": "quantitative",
                        "title": "Median price",
                        "legend": {
                            "labelExpr": "join(['$', datum.value, if(datum.value >= 250, '+', '')], '')"
                        }
                    },
                    "fillOpacity": {
                        "condition": {
                            "param": "select",
                            "value": 1
                        },
                        "value": 0.3
                    },
                    "tooltip": [{
                            "field": "properties.ABB_NAME",
                            "type": "nominal",
                            "title": "LGA"
                        },
                        {
                            "field": "med_price",
                            "type": "quantitative",
                            "title": "Median Airbnb Price",
                            "labelExpr": "join(['$', med_price])"
                        }
                    ],
                    "strokeWidth": {
                        "condition": [{
                                "param": "select",
                                "empty": false,
                                "value": 2
                            },
                            {
                                "param": "highlight",
                                "empty": false,
                                "value": 1
                            }
                        ],
                        "value": 0.4
                    }
                }
            }]
        }

        var testspec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "description": "A bar chart with highlighting on hover and selecting on click. (Inspired by Tableau's interaction style.)",
            "data": {
                "values": [{
                        "a": "A",
                        "b": 28
                    }, {
                        "a": "B",
                        "b": 55
                    }, {
                        "a": "C",
                        "b": 43
                    },
                    {
                        "a": "D",
                        "b": 91
                    }, {
                        "a": "E",
                        "b": 81
                    }, {
                        "a": "F",
                        "b": 53
                    },
                    {
                        "a": "G",
                        "b": 19
                    }, {
                        "a": "H",
                        "b": 87
                    }, {
                        "a": "I",
                        "b": 52
                    }
                ]
            },
            "params": [{
                    "name": "highlight",
                    "select": {
                        "type": "point",
                        "on": "mouseover"
                    }
                },
                {
                    "name": "select",
                    "select": "point"
                }
            ],
            "mark": {
                "type": "bar",
                "fill": "#4C78A8",
                "stroke": "black",
                "cursor": "pointer"
            },
            "encoding": {
                "x": {
                    "field": "a",
                    "type": "ordinal"
                },
                "y": {
                    "field": "b",
                    "type": "quantitative"
                },
                "fillOpacity": {
                    "condition": {
                        "param": "select",
                        "value": 1
                    },
                    "value": 0.3
                },
                "strokeWidth": {
                    "condition": [{
                            "param": "select",
                            "empty": false,
                            "value": 2
                        },
                        {
                            "param": "highlight",
                            "empty": false,
                            "value": 1
                        }
                    ],
                    "value": 0
                }
            },
            "config": {
                "scale": {
                    "bandPaddingInner": 0.2
                }
            }
        }

        // Embed the visualization in the container with id `vis`
        // vegaEmbed('#vis', vlSpec);
        // vegaEmbed('#vis2', testspec);
        vegaEmbed('#vis3', vlSpec3);
    </script>
</body>

</html>